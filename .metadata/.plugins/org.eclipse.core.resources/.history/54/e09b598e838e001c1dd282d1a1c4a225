/*
 * serial.c
 *
 *  Created on: 10 Feb 2022
 *      Author: stein
 */

#include <avr/io.h>
#include <avr/interrupt.h>

#include "serial.h"


volatile char cRx;
char serialin;

void Init_Uart(){
	UBRR0H=0;
	UBRR0L = 16;
	UCSR0B=(1<<RXEN0)|(1<<TXEN0)|(1<<RXCIE0);
	UCSR0C=(1<<USBS0)|(3<<UCSZ00);

}

char nibbletohexvalue(unsigned char nibblebyte){
	nibblebyte = nibblebyte & 0x0F;
	unsigned char returnvalue;
	returnvalue=' ';
	if((nibblebyte>=0)&&(nibblebyte<10)){
		returnvalue='0'+nibblebyte;
	}
	else if (( nibblebyte >= 10) && ( nibblebyte <= 15)){
		returnvalue='A'+(nibblebyte-10);
	}
	return returnvalue;
}

void printhexbyte(char inputchar){
	char temp[3];
	temp[0]='0';
	temp[1]='x';
	temp[2]=nibbletohexvalue(inputchar);
	temp[3]=nibbletohexvalue(inputchar>>4);
	for (char i=0;i<=3;i++){
	 char	printchar=temp[i]
	UDR0=printchar;
	}
}

ISR(USART_RX_vect){

	cRx=UDR0;
	serialin=cRx;
	UDR0=cRx;
}






